<!-- Include LogicGate Design System -->
<link rel="stylesheet" href="/logicgate-design-system.css">
<script src="/logicgate-components.js"></script>

<!-- Success Page - LogicGate Risk Cloud Inspired -->
<main class="lg-page">
  <!-- Success Header -->
  <div class="success-header">
    <div class="lg-container">
      <div class="lg-text-center lg-py-8">
        <!-- Success Animation -->
        <div class="success-animation" id="successAnimation">
          <div class="checkmark-circle">
            <div class="checkmark"></div>
          </div>
        </div>
        
        <h1 class="lg-heading-1 lg-text-success-600 lg-mb-4">Assessment Complete!</h1>
        <p class="lg-text-xl lg-text-gray-600 lg-mb-6">
          Congratulations! Your RCSA has been successfully completed in <span class="lg-font-semibold lg-text-primary" id="completionTime">8 minutes</span>.
        </p>
        
        <!-- Achievement Badge -->
        <div class="achievement-badge">
          <div class="lg-flex lg-items-center lg-justify-center lg-gap-2">
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 2L2 7v10c0 5.55 3.84 10 9 10s9-4.45 9-10V7L12 2z"></path>
              <path d="M12 8v8"></path>
              <path d="M8 12h8"></path>
            </svg>
            <span class="lg-font-semibold">Target Achieved: &lt;10 Minutes</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Assessment Summary -->
  <div class="lg-page-content">
    <div class="lg-container">
      
      <!-- Summary Cards -->
      <div class="lg-grid lg-grid-cols-1 lg-md-grid-cols-2 lg-lg-grid-cols-4 lg-gap-6 lg-mb-8">
        <div class="lg-card lg-card-elevated">
          <div class="lg-card-body lg-text-center">
            <div class="summary-icon bg-primary">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                <polyline points="14,2 14,8 20,8"></polyline>
              </svg>
            </div>
            <div class="lg-text-2xl lg-font-bold lg-text-gray-900" id="processName">Loan Origination</div>
            <div class="lg-caption lg-text-gray-500">Process Assessed</div>
          </div>
        </div>
        
        <div class="lg-card lg-card-elevated">
          <div class="lg-card-body lg-text-center">
            <div class="summary-icon bg-warning">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 9v3m0 4h.01M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0z"></path>
              </svg>
            </div>
            <div class="lg-text-2xl lg-font-bold lg-text-gray-900" id="risksCount">5</div>
            <div class="lg-caption lg-text-gray-500">Risks Identified</div>
          </div>
        </div>
        
        <div class="lg-card lg-card-elevated">
          <div class="lg-card-body lg-text-center">
            <div class="summary-icon bg-success">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M9 12l2 2 4-4"></path>
                <path d="M21 12c0 9-9 9-9 9s-9 0-9-9"></path>
              </svg>
            </div>
            <div class="lg-text-2xl lg-font-bold lg-text-gray-900" id="controlsMapped">12</div>
            <div class="lg-caption lg-text-gray-500">Controls Mapped</div>
          </div>
        </div>
        
        <div class="lg-card lg-card-elevated">
          <div class="lg-card-body lg-text-center">
            <div class="summary-icon bg-info">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"></circle>
                <polyline points="12,6 12,12 16,14"></polyline>
              </svg>
            </div>
            <div class="lg-text-2xl lg-font-bold lg-text-gray-900" id="timeSpent">8:42</div>
            <div class="lg-caption lg-text-gray-500">Time Spent</div>
          </div>
        </div>
      </div>

      <!-- Detailed Results -->
      <div class="lg-grid lg-grid-cols-1 lg-lg-grid-cols-2 lg-gap-6 lg-mb-8">
        
        <!-- Risk Distribution -->
        <div class="lg-card">
          <div class="lg-card-header">
            <h3 class="lg-heading-4">Risk Distribution</h3>
          </div>
          <div class="lg-card-body">
            <div class="risk-summary" id="riskSummary">
              <div class="risk-level-summary">
                <div class="lg-flex lg-items-center lg-justify-between lg-mb-3">
                  <div class="lg-flex lg-items-center lg-gap-2">
                    <div class="risk-indicator critical"></div>
                    <span class="lg-font-medium">Critical</span>
                  </div>
                  <span class="lg-font-bold" id="criticalCount">0</span>
                </div>
                
                <div class="lg-flex lg-items-center lg-justify-between lg-mb-3">
                  <div class="lg-flex lg-items-center lg-gap-2">
                    <div class="risk-indicator high"></div>
                    <span class="lg-font-medium">High</span>
                  </div>
                  <span class="lg-font-bold" id="highCount">2</span>
                </div>
                
                <div class="lg-flex lg-items-center lg-justify-between lg-mb-3">
                  <div class="lg-flex lg-items-center lg-gap-2">
                    <div class="risk-indicator medium"></div>
                    <span class="lg-font-medium">Medium</span>
                  </div>
                  <span class="lg-font-bold" id="mediumCount">2</span>
                </div>
                
                <div class="lg-flex lg-items-center lg-justify-between">
                  <div class="lg-flex lg-items-center lg-gap-2">
                    <div class="risk-indicator low"></div>
                    <span class="lg-font-medium">Low</span>
                  </div>
                  <span class="lg-font-bold" id="lowCount">1</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Key Achievements -->
        <div class="lg-card">
          <div class="lg-card-header">
            <h3 class="lg-heading-4">Key Achievements</h3>
          </div>
          <div class="lg-card-body">
            <div class="achievements-list">
              <div class="achievement-item">
                <div class="achievement-icon bg-success">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="20,6 9,17 4,12"></polyline>
                  </svg>
                </div>
                <div>
                  <div class="lg-font-medium">Completed Under Target Time</div>
                  <div class="lg-text-sm lg-text-gray-500">Finished in 8:42 (target: &lt;10 minutes)</div>
                </div>
              </div>
              
              <div class="achievement-item">
                <div class="achievement-icon bg-info">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M9 12l2 2 4-4"></path>
                    <path d="M21 12c0 9-9 9-9 9s-9 0-9-9"></path>
                  </svg>
                </div>
                <div>
                  <div class="lg-font-medium">Comprehensive Risk Coverage</div>
                  <div class="lg-text-sm lg-text-gray-500">Identified 5 risks across all major categories</div>
                </div>
              </div>
              
              <div class="achievement-item">
                <div class="achievement-icon bg-warning">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 2L2 7v10c0 5.55 3.84 10 9 10s9-4.45 9-10V7L12 2z"></path>
                  </svg>
                </div>
                <div>
                  <div class="lg-font-medium">Effective Control Mapping</div>
                  <div class="lg-text-sm lg-text-gray-500">Mapped 12 controls with 85% effectiveness</div>
                </div>
              </div>
              
              <div class="achievement-item">
                <div class="achievement-icon bg-primary">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
                    <polyline points="14,2 14,8 20,8"></polyline>
                  </svg>
                </div>
                <div>
                  <div class="lg-font-medium">Detailed Documentation</div>
                  <div class="lg-text-sm lg-text-gray-500">Provided comprehensive rationale and evidence</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Next Steps -->
      <div class="lg-card lg-mb-8">
        <div class="lg-card-header">
          <h3 class="lg-heading-4">Recommended Next Steps</h3>
        </div>
        <div class="lg-card-body">
          <div class="lg-grid lg-grid-cols-1 lg-md-grid-cols-2 lg-gap-6">
            <div class="next-step-item">
              <div class="step-number">1</div>
              <div>
                <h4 class="lg-font-semibold lg-mb-2">Review High-Risk Items</h4>
                <p class="lg-text-sm lg-text-gray-600">
                  Address the 2 high-risk items identified in your assessment. Consider implementing additional controls or mitigation strategies.
                </p>
              </div>
            </div>
            
            <div class="next-step-item">
              <div class="step-number">2</div>
              <div>
                <h4 class="lg-font-semibold lg-mb-2">Schedule Follow-up Review</h4>
                <p class="lg-text-sm lg-text-gray-600">
                  Plan a follow-up assessment in 6 months to monitor risk changes and control effectiveness.
                </p>
              </div>
            </div>
            
            <div class="next-step-item">
              <div class="step-number">3</div>
              <div>
                <h4 class="lg-font-semibold lg-mb-2">Share Results with Stakeholders</h4>
                <p class="lg-text-sm lg-text-gray-600">
                  Distribute the assessment report to relevant stakeholders and discuss implementation of recommendations.
                </p>
              </div>
            </div>
            
            <div class="next-step-item">
              <div class="step-number">4</div>
              <div>
                <h4 class="lg-font-semibold lg-mb-2">Update Risk Register</h4>
                <p class="lg-text-sm lg-text-gray-600">
                  Ensure all identified risks are properly documented in your organization's risk register.
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="lg-flex lg-items-center lg-justify-center lg-gap-4 lg-flex-wrap">
        <button class="lg-btn lg-btn-primary lg-btn-lg" onclick="successPage.viewDashboard()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="3" y="3" width="7" height="7"></rect>
            <rect x="14" y="3" width="7" height="7"></rect>
            <rect x="14" y="14" width="7" height="7"></rect>
            <rect x="3" y="14" width="7" height="7"></rect>
          </svg>
          View Dashboard
        </button>
        
        <button class="lg-btn lg-btn-outline lg-btn-lg" onclick="successPage.downloadReport()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
            <polyline points="7,10 12,15 17,10"></polyline>
            <line x1="12" y1="15" x2="12" y2="3"></line>
          </svg>
          Download Report
        </button>
        
        <button class="lg-btn lg-btn-ghost lg-btn-lg" onclick="successPage.startAnother()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="12" y1="5" x2="12" y2="19"></line>
            <line x1="5" y1="12" x2="19" y2="12"></line>
          </svg>
          Start Another Assessment
        </button>
      </div>
    </div>
  </div>
</main>

<style>
/* Success Page Styles */
.success-header {
  background: linear-gradient(135deg, var(--lg-success-50) 0%, var(--lg-primary-50) 100%);
  border-bottom: 1px solid var(--lg-gray-200);
}

.success-animation {
  margin-bottom: 2rem;
}

.checkmark-circle {
  width: 120px;
  height: 120px;
  border-radius: 50%;
  background: var(--lg-success-100);
  border: 4px solid var(--lg-success-500);
  margin: 0 auto;
  display: flex;
  align-items: center;
  justify-content: center;
  animation: scaleIn 0.6s ease-out;
}

.checkmark {
  width: 40px;
  height: 40px;
  border-right: 4px solid var(--lg-success-600);
  border-bottom: 4px solid var(--lg-success-600);
  transform: rotate(45deg);
  animation: checkmarkDraw 0.4s ease-out 0.3s both;
}

@keyframes scaleIn {
  from {
    transform: scale(0);
    opacity: 0;
  }
  to {
    transform: scale(1);
    opacity: 1;
  }
}

@keyframes checkmarkDraw {
  from {
    transform: rotate(45deg) scale(0);
  }
  to {
    transform: rotate(45deg) scale(1);
  }
}

.achievement-badge {
  display: inline-block;
  padding: 0.75rem 1.5rem;
  background: var(--lg-success-100);
  border: 1px solid var(--lg-success-300);
  border-radius: var(--lg-border-radius-full);
  color: var(--lg-success-700);
  font-size: var(--lg-text-sm);
}

.summary-icon {
  width: 48px;
  height: 48px;
  border-radius: var(--lg-border-radius-lg);
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  margin: 0 auto 1rem;
}

.summary-icon.bg-primary { background: var(--lg-primary-600); }
.summary-icon.bg-success { background: var(--lg-success-600); }
.summary-icon.bg-warning { background: var(--lg-warning-600); }
.summary-icon.bg-info { background: var(--lg-info-600); }

.risk-indicator {
  width: 12px;
  height: 12px;
  border-radius: 50%;
}

.risk-indicator.critical { background: var(--lg-risk-critical); }
.risk-indicator.high { background: var(--lg-risk-high); }
.risk-indicator.medium { background: var(--lg-risk-medium); }
.risk-indicator.low { background: var(--lg-risk-low); }

.achievement-item {
  display: flex;
  align-items: flex-start;
  gap: 1rem;
  margin-bottom: 1rem;
}

.achievement-item:last-child {
  margin-bottom: 0;
}

.achievement-icon {
  width: 32px;
  height: 32px;
  border-radius: var(--lg-border-radius);
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  flex-shrink: 0;
}

.achievement-icon.bg-success { background: var(--lg-success-600); }
.achievement-icon.bg-info { background: var(--lg-info-600); }
.achievement-icon.bg-warning { background: var(--lg-warning-600); }
.achievement-icon.bg-primary { background: var(--lg-primary-600); }

.next-step-item {
  display: flex;
  align-items: flex-start;
  gap: 1rem;
}

.step-number {
  width: 32px;
  height: 32px;
  border-radius: 50%;
  background: var(--lg-primary-600);
  color: white;
  display: flex;
  align-items: center;
  justify-content: center;
  font-weight: var(--lg-font-bold);
  font-size: var(--lg-text-sm);
  flex-shrink: 0;
}

/* Responsive Design */
@media (max-width: 768px) {
  .lg-btn-lg {
    width: 100%;
    margin-bottom: 0.5rem;
  }
  
  .success-animation .checkmark-circle {
    width: 80px;
    height: 80px;
  }
  
  .success-animation .checkmark {
    width: 30px;
    height: 30px;
  }
}
</style>

<script>
// Success Page Application
const successPage = {
  data: {
    assessmentId: 'ASS-2024-001',
    processName: 'Loan Origination',
    businessUnit: 'Commercial Banking',
    completionTime: '8:42',
    risksIdentified: 5,
    controlsMapped: 12,
    riskDistribution: {
      critical: 0,
      high: 2,
      medium: 2,
      low: 1
    }
  },

  init() {
    this.loadAssessmentData();
    this.animateSuccess();
    this.updateSummary();
  },

  loadAssessmentData() {
    // In a real app, this would load from the completed assessment
    // For now, we'll use mock data
    setTimeout(() => {
      this.updateDisplayData();
    }, 500);
  },

  updateDisplayData() {
    document.getElementById('processName').textContent = this.data.processName;
    document.getElementById('completionTime').textContent = this.data.completionTime;
    document.getElementById('risksCount').textContent = this.data.risksIdentified;
    document.getElementById('controlsMapped').textContent = this.data.controlsMapped;
    document.getElementById('timeSpent').textContent = this.data.completionTime;
    
    // Update risk distribution
    document.getElementById('criticalCount').textContent = this.data.riskDistribution.critical;
    document.getElementById('highCount').textContent = this.data.riskDistribution.high;
    document.getElementById('mediumCount').textContent = this.data.riskDistribution.medium;
    document.getElementById('lowCount').textContent = this.data.riskDistribution.low;
  },

  animateSuccess() {
    // Trigger success animation
    setTimeout(() => {
      LogicGate.Toast.show('Assessment completed successfully!', 'success', 3000);
    }, 1000);
  },

  updateSummary() {
    // Any additional summary updates
    const totalRisks = Object.values(this.data.riskDistribution).reduce((sum, count) => sum + count, 0);
    if (totalRisks !== this.data.risksIdentified) {
      console.warn('Risk count mismatch detected');
    }
  },

  viewDashboard() {
    LogicGate.Toast.show('Redirecting to dashboard...', 'info');
    setTimeout(() => {
      window.location.href = '/dashboard';
    }, 500);
  },

  downloadReport() {
    // Generate assessment report
    const reportData = {
      assessmentId: this.data.assessmentId,
      processName: this.data.processName,
      businessUnit: this.data.businessUnit,
      completionTime: this.data.completionTime,
      risksIdentified: this.data.risksIdentified,
      controlsMapped: this.data.controlsMapped,
      riskDistribution: this.data.riskDistribution,
      generatedAt: new Date().toISOString(),
      summary: {
        totalRisks: this.data.risksIdentified,
        highRiskItems: this.data.riskDistribution.high + this.data.riskDistribution.critical,
        controlEffectiveness: '85%',
        recommendations: [
          'Review high-risk items immediately',
          'Schedule follow-up assessment in 6 months',
          'Share results with stakeholders',
          'Update risk register'
        ]
      }
    };

    // Use LogicGate export utility
    LogicGate.Export.toJSON(reportData, `RCSA-Report-${this.data.assessmentId}.json`);
    LogicGate.Toast.show('Assessment report downloaded successfully!', 'success');
  },

  startAnother() {
    const confirmed = confirm('Are you sure you want to start another assessment? This will take you back to the process selection page.');
    if (confirmed) {
      LogicGate.Toast.show('Starting new assessment...', 'info');
      setTimeout(() => {
        window.location.href = '/process-selection';
      }, 500);
    }
  },

  shareResults() {
    // Future feature: Share assessment results
    LogicGate.Toast.show('Sharing feature coming soon!', 'info');
  }
};

// Initialize when page loads
document.addEventListener('DOMContentLoaded', () => {
  successPage.init();
});
</script>
